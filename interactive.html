<!-- 
finding_time_interactive.html 
attribution for ares symbol here: https://commons.wikimedia.org/wiki/File:Male_black_symbol.svg
same user made the venus symbol
-->

<html>

<head>
	<title>Finding Time Interactive</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.4.1/snap.svg-min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/ScrollMagic.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.16.1/plugins/TextPlugin.min.js"></script>
	<script src="lib/TweenMax.min.js"></script>
	<script src="lib/animation.gsap.js"></script>
	<style>
		@import url(https://fonts.googleapis.com/css?family=Lato:300,400,700);
		@-webkit-keyframes dash{to{stroke-dashoffset:-1000;}}

		h1{font-family:sans-serif;width:700px;margin-left:auto;margin-right:auto;}
		h2{font-family:sans-serif;width:700px;margin-left:auto;margin-right:auto;font-size:1.2em;}
		p{width:700px;margin-left:auto;margin-right:auto;}
		html, body {
		    max-width: 100% !important;
		    overflow-x: hidden !important;
		}

		.ants{-webkit-animation: dash 30s linear infinite}
		.constraint{position:relative;margin-left:auto;margin-right:auto;}
		.scrollcontainer{overflow-y:scroll;overflow-x:hidden;width:100%;height:100%;margin:auto;}
		.icon{position:absolute;width:32px;height:32px}
		.headlinetext0{font-family:'Lato';font-size:2em;color:#999;font-weight:700;position:absolute;}
		.headlinetext2{font-family:'Lato';font-size:3.5em;color:#3d3242;font-weight:700;position:absolute;line-height:100%;}
		.headlinetext4{font-family:'Lato';font-size:2.5em;color:#3d3242;font-weight:700;position:absolute;line-height:100%;}
		.headlinetext3{font-family:'Lato';font-size:1.4em;color:#999;font-weight:700;height:0;position:absolute;line-height:90%;}
		.stoptext{font-family:'Lato';font-size:1.5em;color:#3d3242;font-weight:400;position:absolute;line-height:90%;opacity:0;margin:0;padding:0;transform:translate(0,-50%);}
		.stoptext2{text-align:center;font-size:2.2em;}
		.lftext{font-family:'Lato';font-size:1.3em;color:#3d3242;font-weight:400;position:absolute;line-height:90%;margin:0;padding:0;}
		.timeicons{padding-left:35px;}
		.hoursrow{position:relative;font-family:'Lato';font-size:1.5em;color:#666;font-weight:700;line-height:90%;padding:13px;}
		.hoursrow:not(:first-child){padding-top:2px;}
		.hourstable{position:absolute;background-color:rgba(255,255,255,.9);border-radius:4px;opacity:0;}
		.buffer{margin-left:35px;}
		.lfbox{position:absolute;border:.5px solid black;background:#dddddd;padding:3px;font-family:'Lato';opacity:.8;z-index:1000;}
		.lfbox2{position:absolute;border:.5px solid black;background:#dddddd;padding:3px;font-family:'Lato';opacity:0;text-align:center;}
		.male{color:#fc8d62;}
		.female{color:#67c2a5}
		.pointer{position:absolute;width:1px;background:black;height:40px;opacity:0;}
		.recession{color:#ccc;}

		#venus{position:absolute;}
		#ares{position:absolute;}
		/*#graph2{position:absolute;}*/
		#graph3{position:absolute;}
	</style>
</head>
<body>

<div class='scrollcontainer' id='examplewrapper'>
<h1>Header</h1>

<p>Austin raw denim art party tattooed. Vinyl williamsburg microdosing thundercats vegan. Banh mi poutine truffaut, migas before they sold out waistcoat photo booth paleo vice sartorial banjo. Chicharrones DIY pinterest, tacos blue bottle kitsch banjo vinyl ethical kale chips blog salvia pitchfork. Man bun godard pop-up twee, heirloom listicle master cleanse artisan 90's flexitarian tilde. Organic lumbersexual chia tote bag small batch, pabst mlkshk street art food truck paleo ramps. Jean shorts heirloom polaroid direct trade viral.</p>

<div id='trigger'></div>
<div id='pin'>
	<div class='constraint' id='inner'>
		<div id='ares'><svg id='ares_svg' viewbox='0 0 400 402' xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" sodipodi:version="0.32" inkscape:version="0.46" version="1.0" sodipodi:docname="Male black symbol.svg" inkscape:output_extension="org.inkscape.output.svg.inkscape"><metadata id="metadata7"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /></cc:Work></rdf:RDF></metadata><defs id="defs5"><inkscape:perspective sodipodi:type="inkscape:persp3d" inkscape:vp_x="0 : 526.18109 : 1" inkscape:vp_y="0 : 1000 : 0" inkscape:vp_z="744.09448 : 526.18109 : 1" inkscape:persp3d-origin="372.04724 : 350.78739 : 1" id="perspective9" /><inkscape:perspective id="perspective11" inkscape:persp3d-origin="105 : 70 : 1" inkscape:vp_z="210 : 105 : 1" inkscape:vp_y="0 : 1000 : 0" inkscape:vp_x="0 : 105 : 1" sodipodi:type="inkscape:persp3d" /></defs><sodipodi:namedview inkscape:window-height="712" inkscape:window-width="1024" inkscape:pageshadow="2" inkscape:pageopacity="0.0" guidetolerance="10.0" gridtolerance="10.0" objecttolerance="10.0" borderopacity="1.0" bordercolor="#666666" pagecolor="#ffffff" id="base" showgrid="false" inkscape:zoom="1.155" inkscape:cx="200" inkscape:cy="200" inkscape:window-x="-4" inkscape:window-y="-4" inkscape:current-layer="svg2" /><path style="fill:#fc8d62;stroke:#000000;stroke-width:0;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none" id="path4" stroke-miterlimit="4" d="M 313.08211,1.8287384e-06 L 296.52632,28.972622 L 337.91579,28.972622 L 261.34529,105.54314 C 192.66194,54.224462 96.00127,64.683002 39.884171,129.5049 C -16.232929,194.32679 -12.740749,291.48886 47.885186,352.11481 C 108.51112,412.74073 205.67319,416.23294 270.49511,360.11583 C 335.31699,303.99873 345.77552,207.33806 294.45685,138.65472 L 371.02735,62.084202 L 371.02735,103.47367 L 400,86.917881 L 400,1.8287384e-06 L 313.08211,1.8287384e-06 z M 164.08003,117.95998 C 229.22753,117.95998 282.04002,170.77246 282.04002,235.91997 C 282.04002,301.06747 229.22753,353.87996 164.08003,353.87996 C 98.93253,353.87996 46.120045,301.06747 46.120045,235.91997 C 46.120045,170.77246 98.93253,117.95998 164.08003,117.95998 L 164.08003,117.95998 z" /></svg></div>
		<div id='venus'><svg viewbox='0 0 268 400' xmlns="http://www.w3.org/2000/svg" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><metadata><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:title>Female black symbol</dc:title><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/></cc:Work></rdf:RDF></metadata><ellipse fill="none" stroke-width="34.5396" stroke="#67c2a5" cx="133" cy="130.785" rx="115.7302" ry="113.5152"/><path d="M109.47,257V303.505H56.2729V345.722H109.47V400H156.53V345.722H207.681V303.505H156.53V257Z" fill="#67c2a5"/></svg></div>
		<div id='yearmarker' class='headlinetext2'>1948</div>
		<div id='mhhmarker' class='headlinetext3' style='color:#3d3242'>Families $27k</div>
		<div id='mmmarker' class='headlinetext3' style='color:#fc8d62'>Males $21k</div>
		<div id='mfmarker' class='headlinetext3' style='color:#67c2a5'>Females $9k</div>
		<div id='male_lf_text' class='lfbox'>87%</div>
		<div id='female_lf_text' class='lfbox'>33%</div>
		<div id='male_lf_texthold' class='lfbox2'>1948</div>
		<div id='female_lf_texthold' class='lfbox2'>1948</div>
		<div id='pointer' class='pointer'></div>
		<div id='graphlabel' class='headlinetext4'>Median Incomes, 2014 $</div>

		<div id='lf1' class='lftext' style='opacity:100%'>Male labor force participation</div>
		<div id='lf2' class='lftext' style='opacity:100%'>Female labor force participation</div>

		<div id='stop0text' class='stoptext'>Scroll down to see how labor force participation and income has changed for <span class='male'>males</span> and <span class='female'>females</span> since 1948. <span class='recession'>Recessions</span> are shaded gray.</div>
		<div id='stop1text' class='stoptext'>Up until the 1990s, <span class='female'>female</span> participation in the labor force and <span class='female'>female</span> pay rose, and family income rose with it.</div>
		<div id='stop2text1' class='stoptext'>But <span class='female'>female</span> labor force participation leveled off in the 90s.</div>
		<div id='stop2text12' class='stoptext'><span class='male'>Male</span> labor force participation declined, and <span class='male'>male</span> median income has been stagnant since 1979.</div>
		<div id='stop2text2' class='stoptext'>The result is that family incomes grew quickly before 1979, but have risen slowly since.</div>
		<div id='stop2text3' class='stoptext'>But the problem isn't just that incomes are stagnant.</div>
		<svg id='graph1'></svg>
	</div>
</div>

<div id='trigger2'></div>
<div id='pin2'>
	<div class='constraint' id='inner2'>
		<div id='stop3text1' class='stoptext stoptext2'>Unlike in 1948, both parents (or a single parent) work.</div>
		<div id='stop3text2' class='stoptext stoptext2'>Mothers are doing more paid work and more child care. Fathers are doing more housework and child care.</div>
		<div id='stop3text3' class='stoptext stoptext2'>So families are working more but incomes are flat.</div>
		<div id='stop3text4' class='stoptext stoptext2'>This isn't just a problem for families. It's a problem for our economy.</div>
		<div id='stop3text5' class='stoptext stoptext2'>With less time, workers are less productive, and worker turnover is higher.</div>
		<div id='stop3text6' class='stoptext stoptext2'>Our workplaces and our labor laws weren't designed with modern families in mind.</div>
		<svg id='graph2'></svg>
		<svg id='graph3'></svg>
	</div>
</div>

<p>Austin raw denim art party tattooed. Vinyl williamsburg microdosing thundercats vegan. Banh mi poutine truffaut, migas before they sold out waistcoat photo booth paleo vice sartorial banjo. Chicharrones DIY pinterest, tacos blue bottle kitsch banjo vinyl ethical kale chips blog salvia pitchfork. Man bun godard pop-up twee, heirloom listicle master cleanse artisan 90's flexitarian tilde. Organic lumbersexual chia tote bag small batch, pabst mlkshk street art food truck paleo ramps. Jean shorts heirloom polaroid direct trade viral.</p>
<p>Austin raw denim art party tattooed. Vinyl williamsburg microdosing thundercats vegan. Banh mi poutine truffaut, migas before they sold out waistcoat photo booth paleo vice sartorial banjo. Chicharrones DIY pinterest, tacos blue bottle kitsch banjo vinyl ethical kale chips blog salvia pitchfork. Man bun godard pop-up twee, heirloom listicle master cleanse artisan 90's flexitarian tilde. Organic lumbersexual chia tote bag small batch, pabst mlkshk street art food truck paleo ramps. Jean shorts heirloom polaroid direct trade viral.</p>
<p>Austin raw denim art party tattooed. Vinyl williamsburg microdosing thundercats vegan. Banh mi poutine truffaut, migas before they sold out waistcoat photo booth paleo vice sartorial banjo. Chicharrones DIY pinterest, tacos blue bottle kitsch banjo vinyl ethical kale chips blog salvia pitchfork. Man bun godard pop-up twee, heirloom listicle master cleanse artisan 90's flexitarian tilde. Organic lumbersexual chia tote bag small batch, pabst mlkshk street art food truck paleo ramps. Jean shorts heirloom polaroid direct trade viral.</p>
<p>Austin raw denim art party tattooed. Vinyl williamsburg microdosing thundercats vegan. Banh mi poutine truffaut, migas before they sold out waistcoat photo booth paleo vice sartorial banjo. Chicharrones DIY pinterest, tacos blue bottle kitsch banjo vinyl ethical kale chips blog salvia pitchfork. Man bun godard pop-up twee, heirloom listicle master cleanse artisan 90's flexitarian tilde. Organic lumbersexual chia tote bag small batch, pabst mlkshk street art food truck paleo ramps. Jean shorts heirloom polaroid direct trade viral.</p>
<p>Austin raw denim art party tattooed. Vinyl williamsburg microdosing thundercats vegan. Banh mi poutine truffaut, migas before they sold out waistcoat photo booth paleo vice sartorial banjo. Chicharrones DIY pinterest, tacos blue bottle kitsch banjo vinyl ethical kale chips blog salvia pitchfork. Man bun godard pop-up twee, heirloom listicle master cleanse artisan 90's flexitarian tilde. Organic lumbersexual chia tote bag small batch, pabst mlkshk street art food truck paleo ramps. Jean shorts heirloom polaroid direct trade viral.</p>
<p>Austin raw denim art party tattooed. Vinyl williamsburg microdosing thundercats vegan. Banh mi poutine truffaut, migas before they sold out waistcoat photo booth paleo vice sartorial banjo. Chicharrones DIY pinterest, tacos blue bottle kitsch banjo vinyl ethical kale chips blog salvia pitchfork. Man bun godard pop-up twee, heirloom listicle master cleanse artisan 90's flexitarian tilde. Organic lumbersexual chia tote bag small batch, pabst mlkshk street art food truck paleo ramps. Jean shorts heirloom polaroid direct trade viral.</p>
<p>Austin raw denim art party tattooed. Vinyl williamsburg microdosing thundercats vegan. Banh mi poutine truffaut, migas before they sold out waistcoat photo booth paleo vice sartorial banjo. Chicharrones DIY pinterest, tacos blue bottle kitsch banjo vinyl ethical kale chips blog salvia pitchfork. Man bun godard pop-up twee, heirloom listicle master cleanse artisan 90's flexitarian tilde. Organic lumbersexual chia tote bag small batch, pabst mlkshk street art food truck paleo ramps. Jean shorts heirloom polaroid direct trade viral.</p>

</div>

</body>
<script>
	// census data from tables p2 and f7 and participation data from FRED
	var data={1948: {'lf_female': 32.7, 'mm_income': 20576, 'mhh_income': 27369, 'mf_income': 8665, 'lf_male': 86.6}, 1949: {'lf_female': 33.2, 'mm_income': 20398, 'mhh_income': 27015, 'mf_income': 8347, 'lf_male': 86.6}, 1950: {'lf_female': 33.8, 'mm_income': 22070, 'mhh_income': 28502, 'mf_income': 8184, 'lf_male': 86.3}, 1951: {'lf_female': 34.6, 'mm_income': 23494, 'mhh_income': 29519, 'mf_income': 8317, 'lf_male': 86.5}, 1952: {'lf_female': 34.7, 'mm_income': 24268, 'mhh_income': 30403, 'mf_income': 8965, 'lf_male': 86.3}, 1953: {'lf_female': 34.5, 'mm_income': 25006, 'mhh_income': 32932, 'mf_income': 9052, 'lf_male': 86.0}, 1954: {'lf_female': 34.6, 'mm_income': 24569, 'mhh_income': 32064, 'mf_income': 8926, 'lf_male': 85.6}, 1955: {'lf_female': 35.6, 'mm_income': 25954, 'mhh_income': 34146, 'mf_income': 8656, 'lf_male': 85.3}, 1956: {'lf_female': 36.8, 'mm_income': 27405, 'mhh_income': 36378, 'mf_income': 8744, 'lf_male': 85.5}, 1957: {'lf_female': 36.9, 'mm_income': 27095, 'mhh_income': 36593, 'mf_income': 8842, 'lf_male': 84.8}, 1958: {'lf_female': 37.1, 'mm_income': 26842, 'mhh_income': 36480, 'mf_income': 8433, 'lf_male': 84.3}, 1959: {'lf_female': 37.1, 'mm_income': 28429, 'mhh_income': 38528, 'mf_income': 8699, 'lf_male': 83.7}, 1960: {'lf_female': 37.8, 'mm_income': 28552, 'mhh_income': 39329, 'mf_income': 8824, 'lf_male': 83.4}, 1961: {'lf_female': 38.1, 'mm_income': 29023, 'mhh_income': 39734, 'mf_income': 8861, 'lf_male': 82.9}, 1962: {'lf_female': 37.9, 'mm_income': 29992, 'mhh_income': 40858, 'mf_income': 9206, 'lf_male': 82.0}, 1963: {'lf_female': 38.3, 'mm_income': 30524, 'mhh_income': 42284, 'mf_income': 9284, 'lf_male': 81.3}, 1964: {'lf_female': 38.7, 'mm_income': 31022, 'mhh_income': 43852, 'mf_income': 9673, 'lf_male': 81.0}, 1965: {'lf_female': 39.2, 'mm_income': 33025, 'mhh_income': 45740, 'mf_income': 10000, 'lf_male': 80.7}, 1966: {'lf_female': 40.3, 'mm_income': 33923, 'mhh_income': 48155, 'mf_income': 10472, 'lf_male': 80.4}, 1967: {'lf_female': 41.1, 'mm_income': 34427, 'mhh_income': 49182, 'mf_income': 11166, 'lf_male': 80.4}, 1968: {'lf_female': 41.6, 'mm_income': 35675, 'mhh_income': 51496, 'mf_income': 12045, 'lf_male': 80.1}, 1969: {'lf_female': 42.7, 'mm_income': 36716, 'mhh_income': 53872, 'mf_income': 12176, 'lf_male': 79.8}, 1970: {'lf_female': 43.4, 'mm_income': 36304, 'mhh_income': 53705, 'mf_income': 12176, 'lf_male': 79.7}, 1971: {'lf_female': 43.4, 'mm_income': 35995, 'mhh_income': 53630, 'mf_income': 12556, 'lf_male': 79.1}, 1972: {'lf_female': 43.9, 'mm_income': 37716, 'mhh_income': 56276, 'mf_income': 13158, 'lf_male': 78.9}, 1973: {'lf_female': 44.7, 'mm_income': 38382, 'mhh_income': 57416, 'mf_income': 13321, 'lf_male': 78.8}, 1974: {'lf_female': 45.7, 'mm_income': 36608, 'mhh_income': 55882, 'mf_income': 13349, 'lf_male': 78.7}, 1975: {'lf_female': 46.4, 'mm_income': 35432, 'mhh_income': 54908, 'mf_income': 13548, 'lf_male': 77.9}, 1976: {'lf_female': 47.3, 'mm_income': 35673, 'mhh_income': 56609, 'mf_income': 13534, 'lf_male': 77.5}, 1977: {'lf_female': 48.4, 'mm_income': 36037, 'mhh_income': 56990, 'mf_income': 14029, 'lf_male': 77.6}, 1978: {'lf_female': 50.0, 'mm_income': 36429, 'mhh_income': 58766, 'mf_income': 13552, 'lf_male': 77.8}, 1979: {'lf_female': 50.9, 'mm_income': 35842, 'mhh_income': 59601, 'mf_income': 13243, 'lf_male': 77.8}, 1980: {'lf_female': 51.5, 'mm_income': 34287, 'mhh_income': 57528, 'mf_income': 13463, 'lf_male': 77.5}, 1981: {'lf_female': 52.1, 'mm_income': 33663, 'mhh_income': 55938, 'mf_income': 13637, 'lf_male': 77.0}, 1982: {'lf_female': 52.6, 'mm_income': 32871, 'mhh_income': 55217, 'mf_income': 13872, 'lf_male': 76.7}, 1983: {'lf_female': 52.9, 'mm_income': 33086, 'mhh_income': 55585, 'mf_income': 14290, 'lf_male': 76.3}, 1984: {'lf_female': 53.6, 'mm_income': 33868, 'mhh_income': 57387, 'mf_income': 14911, 'lf_male': 76.3}, 1985: {'lf_female': 54.5, 'mm_income': 34236, 'mhh_income': 58215, 'mf_income': 15148, 'lf_male': 76.3}, 1986: {'lf_female': 55.3, 'mm_income': 35283, 'mhh_income': 60732, 'mf_income': 15689, 'lf_male': 76.2}, 1987: {'lf_female': 56.0, 'mm_income': 35470, 'mhh_income': 61762, 'mf_income': 16542, 'lf_male': 76.2}, 1988: {'lf_female': 56.6, 'mm_income': 36373, 'mhh_income': 61925, 'mf_income': 17090, 'lf_male': 76.2}, 1989: {'lf_female': 57.4, 'mm_income': 36685, 'mhh_income': 63093, 'mf_income': 17748, 'lf_male': 76.4}, 1990: {'lf_female': 57.5, 'mm_income': 35664, 'mhh_income': 62131, 'mf_income': 17698, 'lf_male': 76.4}, 1991: {'lf_female': 57.4, 'mm_income': 34710, 'mhh_income': 60944, 'mf_income': 17765, 'lf_male': 75.8}, 1992: {'lf_female': 57.8, 'mm_income': 33829, 'mhh_income': 60485, 'mf_income': 17719, 'lf_male': 75.8}, 1993: {'lf_female': 57.9, 'mm_income': 34057, 'mhh_income': 59649, 'mf_income': 17827, 'lf_male': 75.4}, 1994: {'lf_female': 58.8, 'mm_income': 34337, 'mhh_income': 61311, 'mf_income': 18127, 'lf_male': 75.0}, 1995: {'lf_female': 59.0, 'mm_income': 34829, 'mhh_income': 62692, 'mf_income': 18725, 'lf_male': 75.0}, 1996: {'lf_female': 59.3, 'mm_income': 35823, 'mhh_income': 63578, 'mf_income': 19261, 'lf_male': 74.9}, 1997: {'lf_female': 59.8, 'mm_income': 37093, 'mhh_income': 65570, 'mf_income': 20160, 'lf_male': 75.0}, 1998: {'lf_female': 59.9, 'mm_income': 38455, 'mhh_income': 67843, 'mf_income': 20946, 'lf_male': 74.9}, 1999: {'lf_female': 60.0, 'mm_income': 38792, 'mhh_income': 69405, 'mf_income': 21752, 'lf_male': 74.7}, 2000: {'lf_female': 59.9, 'mm_income': 38963, 'mhh_income': 69741, 'mf_income': 22082, 'lf_male': 74.8}, 2001: {'lf_female': 59.8, 'mm_income': 38913, 'mhh_income': 68740, 'mf_income': 22216, 'lf_male': 74.5}, 2002: {'lf_female': 59.6, 'mm_income': 38475, 'mhh_income': 68007, 'mf_income': 22123, 'lf_male': 74.1}, 2003: {'lf_female': 59.5, 'mm_income': 38527, 'mhh_income': 67809, 'mf_income': 22216, 'lf_male': 73.5}, 2004: {'lf_female': 59.2, 'mm_income': 38247, 'mhh_income': 67756, 'mf_income': 22143, 'lf_male': 73.3}, 2005: {'lf_female': 59.2, 'mm_income': 37914, 'mhh_income': 68122, 'mf_income': 22519, 'lf_male': 73.3}, 2006: {'lf_female': 59.4, 'mm_income': 37886, 'mhh_income': 68582, 'mf_income': 23501, 'lf_male': 73.5}, 2007: {'lf_female': 59.3, 'mm_income': 37904, 'mhh_income': 70057, 'mf_income': 23889, 'lf_male': 73.2}, 2008: {'lf_female': 59.5, 'mm_income': 36463, 'mhh_income': 67648, 'mf_income': 22945, 'lf_male': 73.0}, 2009: {'lf_female': 59.2, 'mm_income': 35513, 'mhh_income': 66303, 'mf_income': 23125, 'lf_male': 72.0}, 2010: {'lf_female': 58.6, 'mm_income': 34970, 'mhh_income': 65408, 'mf_income': 22559, 'lf_male': 71.2}, 2011: {'lf_female': 58.1, 'mm_income': 34723, 'mhh_income': 64185, 'mf_income': 22213, 'lf_male': 70.5}, 2012: {'lf_female': 57.7, 'mm_income': 34959, 'mhh_income': 64179, 'mf_income': 22190, 'lf_male': 70.2}, 2013: {'lf_female': 57.2, 'mm_income': 36213, 'mhh_income': 66542, 'mf_income': 22488, 'lf_male': 69.7}, 2014: {'lf_female': 57.0, 'mm_income': 36302, 'mhh_income': 66632, 'mf_income': 22240, 'lf_male': 69.2}}
	var morphed=0
	var g=Snap('#graph1')
	var g2=Snap('#graph2')
	var g3=Snap('#graph3')
	var gwidth=document.documentElement.clientWidth
	var gheight=document.documentElement.clientHeight
	if(gwidth>1045){gwidth=1045}
	tallflag=0
	if(gheight>gwidth*1.3){tallflag=1}
	var gcenter1=[gwidth/4,gheight/4]
	var gcenter2=[3*gwidth/4,3*gheight/4]
	var gxbounds2=[gwidth/16+10,gwidth-70]
	var gybounds2=[parseInt(70+(gheight-160)/2),gheight-30]
	var gybounds3=[0,(2/3)*gheight-50]
	var gxdomain=gxbounds2[1]-gxbounds2[0]
	var gydomain=gybounds2[1]-gybounds2[0]
	var gxmiddle=gwidth/2
	var gymiddle=gheight/2
	var ymax=75000
	var yearinterval=(gxbounds2[1]-gxbounds2[0])/66
	var year=1964

	document.getElementById('graph1').setAttribute('width',gwidth)
	document.getElementById('graph1').setAttribute('height',gheight)
	document.getElementById('pin2').setAttribute('width',gwidth)
	document.getElementById('pin2').setAttribute('height',gheight)
	document.getElementById('graph2').setAttribute('width',gwidth*(7/16)+10)
	document.getElementById('graph2').setAttribute('height',gheight*(2/3))
	document.getElementById('graph2').style.marginTop=(gheight*(1/3))
	document.getElementById('graph3').setAttribute('width',gwidth*(7/16)+10)
	document.getElementById('graph3').setAttribute('height',gheight*(2/3))
	document.getElementById('graph3').style.marginTop=(gheight*(1/3))
	// document.getElementById('graph3').style.marginLeft=(gwidth*(8/16))
	var num=1

	if(tallflag==1){
		document.getElementById('graph2').setAttribute('width',gwidth)
		document.getElementById('graph2').setAttribute('height',gheight*(2/6))
		document.getElementById('graph3').setAttribute('width',gwidth)
		document.getElementById('graph3').setAttribute('height',gheight*(2/6))
		document.getElementById('graph3').style.marginTop=0
		$("#graph3").css({position: 'static'});		
		var gybounds3=[0,(2/6)*gheight-50]
	}

	var controller=new ScrollMagic.Controller({container:'#examplewrapper'})

	drawpeopleicons(function(){
		// main control function, very slight callback hell
		timeseries(function(){
			setup()
			setup2()

			tween = new TimelineMax()
				// animate up until the first stop
				.add(TweenMax.from($("#stop0text"), 21, {opacity:1, ease:Linear.easeNone}),5)
				.add(TweenMax.to($("#graphlabel"), 10, {opacity:0, ease:Linear.easeNone}),8)
				.add(TweenMax.to($("#mhhmarker"), 31, {marginLeft:gxbounds2[0]+(yearinterval)*31+4, ease:Linear.easeNone}),0)
				.add(TweenMax.to($("#mmmarker"), 31, {marginLeft:gxbounds2[0]+(yearinterval)*31+4, ease:Linear.easeNone}),0)
				.add(TweenMax.to($("#mfmarker"), 31, {marginLeft:gxbounds2[0]+(yearinterval)*31+4, ease:Linear.easeNone}),0)
				.add(TweenMax.to($("rect#mask"), 31, {attr:{width:(yearinterval)*31}, ease:Linear.easeNone}),0)
				.add(TweenMax.to($("#female_lf_texthold"), 2, {opacity:.8, ease:Linear.easeNone}),10)
				.add(TweenMax.to($("#male_lf_texthold"), 2, {opacity:.8, ease:Linear.easeNone}),10)
				.add(TweenMax.to($("#pointer"), 2, {opacity:.8, ease:Linear.easeNone}),10)

				// first stop
				tween.to($("line#familytrend1"), 3, {opacity:1, ease:Linear.easeNone},31)
				tween.to($("line#familytrend1"), 3, {opacity:0, ease:Linear.easeNone},43)
				tween.to($("path#mhh_income_path"), 3, {opacity:.3, ease:Linear.easeNone},31)
				tween.to($("path#mhh_income_path"), 3, {opacity:1, ease:Linear.easeNone},43)
				tween.to($("path#mhh_income_path2"), 0, {opacity:0, ease:Linear.easeNone},31)
				tween.to($("path#mhh_income_path2"), 0, {opacity:1, ease:Linear.easeNone},46)
				.add(TweenMax.to($("#stop1text"), 5, {opacity:1, ease:Linear.easeNone}),26)
				.add(TweenMax.to($("#stop1text"), 5, {opacity:0, ease:Linear.easeNone}),46)

				// continue after the first stop
				.add(TweenMax.to($("#stop2text1"), 5, {opacity:1, ease:Linear.easeNone}),51)
				.add(TweenMax.to($("#stop2text1"), 5, {opacity:0, ease:Linear.easeNone}),66)
				.add(TweenMax.to($("#stop2text12"), 5, {opacity:1, ease:Linear.easeNone}),71)
				.add(TweenMax.to($("#stop2text12"), 5, {opacity:0, ease:Linear.easeNone}),96)
				tween.to($("line#maletrend"), 3, {opacity:1, ease:Linear.easeNone},81)
				tween.to($("line#maletrend"), 3, {opacity:0, ease:Linear.easeNone},101)
				tween.to($("path#mm_income_path2"), 3, {opacity:.3, ease:Linear.easeNone},81)
				tween.to($("path#mm_income_path2"), 3, {opacity:1, ease:Linear.easeNone},101)
				tween.to($("line#familytrend2"), 3, {opacity:1, ease:Linear.easeNone},101)
				tween.to($("line#familytrend2"), 3, {opacity:0, ease:Linear.easeNone},121)
				tween.to($("path#mhh_income_path2"), 3, {opacity:.3, ease:Linear.easeNone},101)
				tween.to($("path#mhh_income_path2"), 3, {opacity:1, ease:Linear.easeNone},121)
				.add(TweenMax.to($("#mhhmarker"), 35, {marginLeft:gxbounds2[1]+4, ease:Linear.easeNone}),46)
				.add(TweenMax.to($("#mmmarker"), 35, {marginLeft:gxbounds2[1]+4, ease:Linear.easeNone}),46)
				.add(TweenMax.to($("#mfmarker"), 35, {marginLeft:gxbounds2[1]+4, ease:Linear.easeNone}),46)
				.add(TweenMax.to($("rect#mask"), 35, {attr:{width:gxdomain}, ease:Linear.easeNone}),46)

				// fade out income markers as they draw close to end
				.add(TweenMax.to($("#mhhmarker"),5,{opacity:0}),75)
				.add(TweenMax.to($("#mmmarker"),5,{opacity:0}),75)
				.add(TweenMax.to($("#mfmarker"),5,{opacity:0}),75)

				// second stop
				.add(TweenMax.to($("#stop2text2"), 5, {opacity:1, ease:Linear.easeNone}),101)
				.add(TweenMax.to($("#stop2text2"), 5, {opacity:0, ease:Linear.easeNone}),116)
				.add(TweenMax.to($("#stop2text3"), 5, {opacity:1, ease:Linear.easeNone}),121)
				.add(TweenMax.to($("#stop2text3"), 5, {opacity:1, ease:Linear.easeNone}),156)

			tween2 = new TimelineMax()
				// continue with story after scroll
				.add(TweenMax.to($("#stop3text1"), 0, {opacity:1, ease:Linear.easeNone}),0)
				.add(TweenMax.to($("#stop3text1"), 5, {opacity:0, ease:Linear.easeNone}),25)
				.add(TweenMax.to($("#stop3text2"), 5, {opacity:1, ease:Linear.easeNone}),30)
				.add(TweenMax.to($("#stop3text2"), 5, {opacity:0, ease:Linear.easeNone}),55)
				.add(TweenMax.to($("#stop3text3"), 5, {opacity:1, ease:Linear.easeNone}),60)
				.add(TweenMax.to($("#stop3text3"), 5, {opacity:0, ease:Linear.easeNone}),85)
				.add(TweenMax.to($("#stop3text4"), 5, {opacity:1, ease:Linear.easeNone}),90)
				.add(TweenMax.to($("#stop3text4"), 5, {opacity:0, ease:Linear.easeNone}),115)
				.add(TweenMax.to($("#stop3text5"), 5, {opacity:1, ease:Linear.easeNone}),120)
				.add(TweenMax.to($("#stop3text5"), 5, {opacity:0, ease:Linear.easeNone}),145)
				.add(TweenMax.to($("#stop3text6"), 5, {opacity:1, ease:Linear.easeNone}),150)
				.add(TweenMax.to($("#stop3text6"), 5, {opacity:1, ease:Linear.easeNone}),175)

				// bars
				.add(TweenMax.from($("rect#mpaid2"), 45, {attr:{height:0,y:get_value2(0)}, ease:Linear.easeOut}),0)
				.add(TweenMax.from($("rect#mhouse2"), 45, {attr:{height:0,y:get_value2(0)}, ease:Linear.easeOut}),0)
				.add(TweenMax.from($("rect#mcare2"), 45, {attr:{height:0,y:get_value2(0)}, ease:Linear.easeOut}),0)

				.add(TweenMax.from($("rect#fpaid2"), 45, {attr:{height:0,y:get_value2(0)}, ease:Linear.easeOut}),0)
				.add(TweenMax.from($("rect#fhouse2"), 45, {attr:{height:0,y:get_value2(0)}, ease:Linear.easeOut}),0)
				.add(TweenMax.from($("rect#fcare2"), 45, {attr:{height:0,y:get_value2(0)}, ease:Linear.easeOut}),0)

				// tags
				.add(TweenMax.from($("text#mtag2"), 15, {opacity:0, ease:Linear.easeOut}),25)
				.add(TweenMax.from($("text#ftag2"), 15, {opacity:0, ease:Linear.easeOut}),25)				

			// yearmarker updates
			for(var i=0;i<83;i++){
				if(i<32){
					tween.set($("#yearmarker"), {text:String(1948+i)},0+i)
				} else if(i>46){
					tween.set($("#yearmarker"), {text:String(1948+i-15)},i)
				}
			}

			// people popping in and out
			for(var i=0;i<82;i++){

				if(i<32){var cyear=1948+i} else if(i>46){var cyear=1948+i-15}

				if(i<32 | i>46){
					var current_female=Math.round(data[cyear]['lf_female'])
					var current_male=Math.round(data[cyear]['lf_male'])
					
					try{
						var next_female=Math.round(data[cyear+1]['lf_female'])
						var next_male=Math.round(data[cyear+1]['lf_male'])
						timing=i+1

						if(current_female<next_female){
							for(j=current_female+1;j<next_female+1;j++){
								tween.to($("#ficon"+j), .9, {scale:1,ease:Elastic.easeOut},timing)
								tween.to($('#female_lf_text'),1, {marginLeft:parseInt($('#ficon'+j).css('margin-left'))+2*personwidth,marginTop:parseInt($('#ficon'+j).css('margin-top'))-8+$('#female_lf_text').height()/2,ease:Linear.easeNone},timing)
								tween.set($('#female_lf_text'),{text:j+'%'},timing)
							}
						} else if(current_female>next_female){
							for(j=current_female;j>next_female;j--){
								tween.to($("#ficon"+j), .9, {scale:0,ease:Elastic.easeIn},timing)
								tween.to($('#female_lf_text'),1, {marginLeft:parseInt($('#ficon'+(j-1)).css('margin-left'))+2*personwidth,marginTop:parseInt($('#ficon'+(j-1)).css('margin-top'))-8+$('#female_lf_text').height()/2,ease:Linear.easeNone},timing)
								tween.set($('#female_lf_text'),{text:(j-1)+'%'},timing)
							}
						}

						if(current_male<next_male){
							for(j=current_male+1;j<next_male+1;j++){
								tween.to($("#micon"+j), .9, {scale:1,ease:Elastic.easeOut},timing)
								tween.to($('#male_lf_text'),1, {marginLeft:parseInt($('#micon'+j).css('margin-left'))+2*personwidth,marginTop:parseInt($('#micon'+j).css('margin-top'))-8+$('#male_lf_text').height()/2,ease:Linear.easeNone},timing)
								tween.set($('#male_lf_text'),{text:j+'%'},timing)
							}
						} else if(current_male>next_male){
							for(j=current_male;j>next_male;j--){
								tween.to($("#micon"+j), .9, {scale:0,ease:Elastic.easeIn},timing)
								tween.to($('#male_lf_text'),1, {marginLeft:parseInt($('#micon'+(j-1)).css('margin-left'))+2*personwidth,marginTop:parseInt($('#micon'+(j-1)).css('margin-top'))-8+$('#male_lf_text').height()/2,ease:Linear.easeNone},timing)
								tween.set($('#male_lf_text'),{text:(j-1)+'%'},timing)
							}
						}
					} catch(err){}
				}
			}

			// income tags
			for (var i=0;i<82;i++){
				if(i<32){var cyear=1948+i} else if(i>46){var cyear=1948+i-15}

				if(i<32 | i>46){
					timing=i+1
					var female=data[cyear]['mf_income']
					var male=data[cyear]['mm_income']
					var family=data[cyear]['mhh_income']

					tween.to($("#mhhmarker"), .5, {marginTop:get_value(family)-20,ease:Linear.easeNone},timing-1)
					tween.to($("#mmmarker"), 1, {marginTop:get_value(male)-20,ease:Linear.easeNone},timing-1)
					tween.to($("#mfmarker"), 1, {marginTop:get_value(female)-20,ease:Linear.easeNone},timing-1)

					tween.set($("#mhhmarker"), {text:'Families $'+Math.round(family/1000)+'k'},timing-1)
					tween.set($("#mfmarker"), {text:'Females $'+Math.round(female/1000)+'k'},timing-1)
					tween.set($("#mmmarker"), {text:'Males $'+Math.round(male/1000)+'k'},timing-1)
				}
			}

			new ScrollMagic.Scene({offset:document.getElementById('trigger').offsetTop,duration:8000,})
				.setPin('#pin')
				.setTween(tween)
				.addTo(controller)

			new ScrollMagic.Scene({offset:document.getElementById('trigger2').offsetTop,duration:8000*(180/126),})
				.setPin('#pin2')
				.setTween(tween2)
				.addTo(controller)
		})
	})


	function setup(){
		// use this function to position everything

		// linemarkers
		document.getElementById("mhhmarker").style.width=40
		document.getElementById("mhhmarker").style.marginTop=get_value(27369)-20
		document.getElementById("mhhmarker").style.marginLeft=gwidth/16+14

		document.getElementById("mmmarker").style.width=40
		document.getElementById("mmmarker").style.marginTop=get_value(20576)-20
		document.getElementById("mmmarker").style.marginLeft=gwidth/16+14

		document.getElementById("mfmarker").style.width=40
		document.getElementById("mfmarker").style.marginTop=get_value(8665)-20
		document.getElementById("mfmarker").style.marginLeft=gwidth/16+14

		// stoptext positions
		function sizes(callback){
			$('.stoptext').css({width:gxbounds2[1]-(gxbounds2[0]+$('#yearmarker').width()+30),left:gxbounds2[0]+$('#yearmarker').width()+30})
			callback()
		}

		sizes(function(){
			a=$('.stoptext')
			for(var i=0;i<a.length;i++){
				$(a[i]).css({top:midline})
			}
		})

		// stoptext2 positions
		$('.stoptext2').css({width:6*gwidth/8,left:gwidth/8,top:gheight/6})	

		// axes and graph title
		var yaxis2=g.line(gxbounds2[0]-10,gybounds2[0],gxbounds2[1],gybounds2[0]).attr({stroke:'#ddd','stroke-width':1,'shape-rendering':'crispEdges'})
		var yaxis2=g.line(gxbounds2[0]-10,get_value(75000),gxbounds2[1],get_value(75000)).attr({stroke:'#ddd','stroke-width':1,'shape-rendering':'crispEdges'})
		var yaxis3=g.line(gxbounds2[0]-10,get_value(60000),gxbounds2[1],get_value(60000)).attr({stroke:'#ddd','stroke-width':1,'shape-rendering':'crispEdges'})
		var yaxis4=g.line(gxbounds2[0]-10,get_value(45000),gxbounds2[1],get_value(45000)).attr({stroke:'#ddd','stroke-width':1,'shape-rendering':'crispEdges'})
		var yaxis5=g.line(gxbounds2[0]-10,get_value(30000),gxbounds2[1],get_value(30000)).attr({stroke:'#ddd','stroke-width':1,'shape-rendering':'crispEdges'})
		var yaxis6=g.line(gxbounds2[0]-10,get_value(15000),gxbounds2[1],get_value(15000)).attr({stroke:'#ddd','stroke-width':1,'shape-rendering':'crispEdges'})

		var yamarker1=g.text(gxbounds2[0]-15,get_value(75000),'$75k').attr({'font-family':'Lato','font-size':'20px',fill:'#3d3242','text-anchor':'end'})
		ya1=yamarker1.getBBox()
		yamarker1.attr({y:ya1.y+ya1.height})
		var yamarker1=g.text(gxbounds2[0]-15,get_value(60000),'60').attr({'font-family':'Lato','font-size':'20px',fill:'#3d3242','text-anchor':'end'})
		ya1=yamarker1.getBBox()
		yamarker1.attr({y:ya1.y+ya1.height})
		var yamarker2=g.text(gxbounds2[0]-15,get_value(45000)+2,'45').attr({'font-family':'Lato','font-size':'20px',fill:'#3d3242','text-anchor':'end'})
		ya2=yamarker2.getBBox()
		yamarker2.attr({y:ya2.y+ya2.height})
		var yamarker3=g.text(gxbounds2[0]-15,get_value(30000)+2,'30').attr({'font-family':'Lato','font-size':'20px',fill:'#3d3242','text-anchor':'end'})
		ya3=yamarker3.getBBox()
		yamarker3.attr({y:ya3.y+ya3.height})
		var yamarker32=g.text(gxbounds2[0]-15,get_value(15000)+2,'15').attr({'font-family':'Lato','font-size':'20px',fill:'#3d3242','text-anchor':'end'})
		ya32=yamarker32.getBBox()
		yamarker32.attr({y:ya32.y+ya32.height})
		var yamarker4=g.text(gxbounds2[0]-15,get_value(0),'0').attr({'font-family':'Lato','font-size':'20px',fill:'#3d3242','text-anchor':'end'})
		ya4=yamarker4.getBBox()
		yamarker4.attr({y:ya4.y+ya4.height})

		// recessions text
		// var rectext=g.text(gxbounds2[0]+yearinterval*5.583+yearinterval*(1.33)/2,gybounds2[1]+15,'recessions').attr({'font-family':'Lato',fill:'#ccc','font-weight':200,'text-anchor':'middle'})
		// linegroup.append(rectext)

		// pull paths to front
		g.append(linegroup)

		// add crawling ants arrows
		var arrowhead=g.path('M0,0 L0,3.5 L3.5,1.75 L0,0').attr({fill: '#3d3242'})
		var arrowhead2=g.path('M0,0 L0,3.5 L3.5,1.75 L0,0').attr({fill: '#fc8d62'})
		var amarker_male=arrowhead2.marker(0,0,3.5,3.5,0,1.75).attr({fill:'#fc8d62'})
		var amarker_family=arrowhead.marker(0,0,3.5,3.5,0,1.75).attr({fill:'#3d3242'})
		// var amarker = arrow.marker(0,0,6,4,0,2).attr({fill:'currentColor'});

		var earlyfamilytrend=g.line(gxbounds2[0],get_value(27369),gxbounds2[0]+yearinterval*31.2-15,get_value(58901)).attr({class:'ants','stroke-width':4,'stroke-dasharray':[12,12],stroke:'#3d3242','marker-end':amarker_family,opacity:0,id:'familytrend1'})
		var postvolcanofamilytrend=g.line(gxbounds2[0]+yearinterval*31,get_value(59801),gxbounds2[0]+yearinterval*66,get_value(66632)).attr({class:'ants','stroke-width':4,'stroke-dasharray':[12,12],stroke:'#3d3242','marker-end':amarker_family,opacity:0,id:'familytrend2'})
		var postvolcanomaletrend=g.line(gxbounds2[0]+yearinterval*31,get_value(35842),gxbounds2[0]+yearinterval*66,get_value(36302)).attr({class:'ants','stroke-width':4,'stroke-dasharray':[12,12],stroke:'#fc8d62','marker-end':amarker_male,opacity:0,id:'maletrend'})
	}

	function setup2(){
		// setup for the 2nd graph (bar graph)
		// baseline and text
		var ninths=(gwidth-100)/16
		var thirds=(7*ninths)/4
		barwidth=(50+.5*thirds)/2

		if(tallflag==1){
			var ninths=(gwidth-100)/8
			var thirds=(7*ninths)/4
			barwidth=(50+.5*thirds)/2
		}

		g2.line(45,get_value2(10),7*ninths+50,get_value2(10)).attr({'stroke-width':1,'stroke':'#ddd','shape-rendering':'crispEdges'})
		g2.line(45,get_value2(20),7*ninths+50,get_value2(20)).attr({'stroke-width':1,'stroke':'#ddd','shape-rendering':'crispEdges'})
		g2.line(45,get_value2(30),7*ninths+50,get_value2(30)).attr({'stroke-width':1,'stroke':'#ddd','shape-rendering':'crispEdges'})
		g2.line(45,get_value2(40),7*ninths+50,get_value2(40)).attr({'stroke-width':1,'stroke':'#ddd','shape-rendering':'crispEdges'})

		g3.line(45,get_value2(10),7*ninths+50,get_value2(10)).attr({'stroke-width':1,'stroke':'#ddd','shape-rendering':'crispEdges'})
		g3.line(45,get_value2(20),7*ninths+50,get_value2(20)).attr({'stroke-width':1,'stroke':'#ddd','shape-rendering':'crispEdges'})
		g3.line(45,get_value2(30),7*ninths+50,get_value2(30)).attr({'stroke-width':1,'stroke':'#ddd','shape-rendering':'crispEdges'})
		g3.line(45,get_value2(40),7*ninths+50,get_value2(40)).attr({'stroke-width':1,'stroke':'#ddd','shape-rendering':'crispEdges'})

		g2.text(40,get_value2(10)+6,'10').attr({'font-family':'Lato',fill:'#3d3242','text-anchor':'end'})
		g2.text(40,get_value2(20)+6,'20').attr({'font-family':'Lato',fill:'#3d3242','text-anchor':'end'})
		g2.text(40,get_value2(30)+6,'30').attr({'font-family':'Lato',fill:'#3d3242','text-anchor':'end'})
		g2.text(40,get_value2(40)+6,'40').attr({'font-family':'Lato',fill:'#3d3242','text-anchor':'end'})

		g2.text(50+2*thirds-.5*barwidth,get_value2(31.9)-3,'1948').attr({'font-family':'Lato','fill':'#33836A','text-anchor':'middle','font-weight':700})
		g3.text(50+.5*thirds-.5*barwidth,get_value2(42)-3,'1948').attr({'font-family':'Lato','fill':'#c63f26','text-anchor':'middle','font-weight':700})
		g2.text(50+2*thirds+.5*barwidth,get_value2(17.6)-3,'2012').attr({'font-family':'Lato','fill':'#67c2a5','text-anchor':'middle','font-weight':700,id:'mtag2'})
		g3.text(50+.5*thirds+.5*barwidth,get_value2(38.5)-3,'2012').attr({'font-family':'Lato','fill':'#fc8d62','text-anchor':'middle','font-weight':700,id:'ftag2'})

		g2.text(50+.5*thirds,get_value2(0)+18,'Paid Work').attr({'font-family':'Lato','font-size':'1em','fill':'#3d3242','text-anchor':'middle'})
		g2.text(50+2*thirds,get_value2(0)+18,'Housework').attr({'font-family':'Lato','font-size':'1em','fill':'#3d3242','text-anchor':'middle'})
		g2.text(50+3.5*thirds,get_value2(0)+18,'Child Care').attr({'font-family':'Lato','font-size':'1em','fill':'#3d3242','text-anchor':'middle'})

		g3.text(50+.5*thirds,get_value2(0)+18,'Paid Work').attr({'font-family':'Lato','font-size':'1em','fill':'#3d3242','text-anchor':'middle'})
		g3.text(50+2*thirds,get_value2(0)+18,'Housework').attr({'font-family':'Lato','font-size':'1em','fill':'#3d3242','text-anchor':'middle'})
		g3.text(50+3.5*thirds,get_value2(0)+18,'Child Care').attr({'font-family':'Lato','font-size':'1em','fill':'#3d3242','text-anchor':'middle'})

		// bars
		g2.rect(50+.5*thirds-barwidth,get_value2(8.4),barwidth,get_value2(0)-get_value2(8.4)).attr({id:'mpaid1',fill:'#33836A','shape-rendering':'crispEdges'})
		g2.rect(50+.5*thirds,get_value2(21.7),barwidth,get_value2(0)-get_value2(21.7)).attr({id:'mpaid2',fill:'#67c2a5','shape-rendering':'crispEdges'})
		g2.rect(50+2*thirds-barwidth,get_value2(31.9),barwidth,get_value2(0)-get_value2(31.9)).attr({id:'mhouse1',fill:'#33836A','shape-rendering':'crispEdges'})
		g2.rect(50+2*thirds,get_value2(17.6),barwidth,get_value2(0)-get_value2(17.6)).attr({id:'mhouse2',fill:'#67c2a5','shape-rendering':'crispEdges'})
		g2.rect(50+3.5*thirds-barwidth,get_value2(10.2),barwidth,get_value2(0)-get_value2(10.2)).attr({id:'mcare1',fill:'#33836A','shape-rendering':'crispEdges'})
		g2.rect(50+3.5*thirds,get_value2(11.8),barwidth,get_value2(0)-get_value2(11.8)).attr({id:'mcare2',fill:'#67c2a5','shape-rendering':'crispEdges'})

		g3.rect(50+.5*thirds-barwidth,get_value2(42),barwidth,get_value2(0)-get_value2(42)).attr({id:'fpaid1',fill:'#c63f26','shape-rendering':'crispEdges'})
		g3.rect(50+.5*thirds,get_value2(38.5),barwidth,get_value2(0)-get_value2(38.5)).attr({id:'fpaid2',fill:'#fc8d62','shape-rendering':'crispEdges'})
		g3.rect(50+2*thirds-barwidth,get_value2(4.4),barwidth,get_value2(0)-get_value2(4.4)).attr({id:'fhouse1',fill:'#c63f26','shape-rendering':'crispEdges'})
		g3.rect(50+2*thirds,get_value2(8.8),barwidth,get_value2(0)-get_value2(8.8)).attr({id:'fhouse2',fill:'#fc8d62','shape-rendering':'crispEdges'})
		g3.rect(50+3.5*thirds-barwidth,get_value2(2.5),barwidth,get_value2(0)-get_value2(2.5)).attr({id:'fcare1',fill:'#c63f26','shape-rendering':'crispEdges'})
		g3.rect(50+3.5*thirds,get_value2(7.1),barwidth,get_value2(0)-get_value2(7.1)).attr({id:'fcare2',fill:'#fc8d62','shape-rendering':'crispEdges'})

		g2.line(50,get_value2(0),7*ninths+50,get_value2(0)).attr({'stroke-width':2,'stroke':'black','shape-rendering':'crispEdges'})
		g3.line(50,get_value2(0),7*ninths+50,get_value2(0)).attr({'stroke-width':2,'stroke':'black','shape-rendering':'crispEdges'})

		g2.text(7*ninths+50,get_value2(40),'Mothers').attr({'font-family':'Lato','font-size':'1.5em','fill':'#67c2a5','font-weight':700,'text-anchor':'end'})
		g3.text(7*ninths+50,get_value2(40),'Fathers').attr({'font-family':'Lato','font-size':'1.5em','fill':'#fc8d62','font-weight':700,'text-anchor':'end'})
		g2.text(60,get_value2(40),'Hours per week').attr({'font-family':'Lato','font-size':'1.4em','font-weight':700,'fill':'#777'})
	}

	function get_value2(y){
		return gybounds3[1]-(y/45)*(gybounds3[1]-gybounds3[0])
	}

	// setup for the labor force people
	function drawpeopleicons(callback){

		// ares and venus setup
		document.getElementById("ares").style.width=gydomain/5
		document.getElementById("ares").style.marginLeft=gwidth/60
		document.getElementById("ares").style.marginTop=gheight/32
		if(tallflag==1){document.getElementById("ares").style.marginLeft=gxmiddle-180}

		document.getElementById("venus").style.width=gydomain/5*.75
		document.getElementById("venus").style.marginLeft=16*gwidth/32
		document.getElementById("venus").style.marginTop=gheight/32-5

		// change this based on the width of the person icon
		personwidth=17
		// change this to have more/fewer columns, can control how 'vertical' this part of the graphic is
		var maxcolumns=20
		var columns=Math.floor((15*gwidth/32)/personwidth)
		if(columns>maxcolumns){
			columns=maxcolumns
		}

		var aresheight=gydomain/5
		var venusheight=(gydomain/5*.75)*(400/266)
		var starty=Math.max(aresheight,venusheight)+gheight/32+10
		var startx=gwidth/32

		var maxmales=87
		var maxfemales=60

		var startmales=87
		var startfemales=33

		// males
		var lrow=Math.ceil(maxmales/columns)-1
		for(var i=maxmales;i>0;i--){
			var x=startx+((i-1) % columns*(personwidth))+lrow*10
			if(tallflag==1){var x=gxmiddle-180+((i-1) % columns*(personwidth))+lrow*10}
			var y=starty+lrow*27-((i-1) % columns)*4
			if((i-1) % columns==0){
				lrow=lrow-1
			}
			document.getElementById('inner').insertAdjacentHTML('afterbegin',"<img id='micon"+i+"' class='icon' src='icons/maleperson.png' style='margin-top:"+y+";margin-left:"+x+"' />")
			if(i>68){
				document.getElementById('inner').insertAdjacentHTML('afterbegin',"<img id='fadeicon"+i+"' class='icon' src='icons/maleperson.png' style='margin-top:"+y+";margin-left:"+x+";opacity:"+.3+"' />")
			}
		}
		var lrow=Math.ceil(maxmales/columns)-1
		endy=20+starty+lrow*27-((i-maxmales) % columns)*4

		// females
		if(tallflag!=1){
			var lrow=Math.ceil(maxfemales/columns)-1
			for(var i=maxfemales;i>0;i--){
				var x=gxmiddle+((i-1) % columns*(personwidth))+lrow*10
				var y=starty+lrow*27-((i-1) % columns)*4
				if((i-1) % columns==0){
					lrow=lrow-1
				}
				if(i<startfemales+1){
					document.getElementById('inner').insertAdjacentHTML('afterbegin',"<img id='ficon"+i+"' class='icon' src='icons/person.png' style='margin-top:"+y+";margin-left:"+x+"' />")
				} else{
					document.getElementById('inner').insertAdjacentHTML('afterbegin',"<img id='ficon"+i+"' class='icon' src='icons/person.png' style='margin-top:"+y+";margin-left:"+x+";transform: scale(0,0)' />")
				}
			}
		} else{
			// if screen is fairly narrow, stack male and female
			document.getElementById("venus").style.marginLeft=gxmiddle-180
			document.getElementById("venus").style.marginTop=endy
			var preserve=endy

			var starty=(gydomain/5*.75)*(400/266)+endy+10
			var lrow=Math.ceil(maxfemales/columns)-1
			for(var i=maxfemales;i>0;i--){
				var x=gxmiddle-180+((i-1) % columns*(personwidth))+lrow*10
				var y=starty+lrow*27-((i-1) % columns)*4
				if((i-1) % columns==0){
					lrow=lrow-1
				}
				if(i<startfemales+1){
					document.getElementById('inner').insertAdjacentHTML('afterbegin',"<img id='ficon"+i+"' class='icon' src='icons/person.png' style='margin-top:"+y+";margin-left:"+x+"' />")
				} else{
					document.getElementById('inner').insertAdjacentHTML('afterbegin',"<img id='ficon"+i+"' class='icon' src='icons/person.png' style='margin-top:"+y+";margin-left:"+x+";transform: scale(0,0)' />")
				}
			}

			var lrow=Math.ceil(maxfemales/columns)-1
			endy=starty+lrow*27-((i-maxfemales) % columns)*4+55
		}

		// labor force participation markers
		document.getElementById('male_lf_text').style.marginLeft=parseInt($('#micon87').css('margin-left'))+2*personwidth
		document.getElementById('male_lf_text').style.marginTop=parseInt($('#micon87').css('margin-top'))-8+$('#female_lf_text').height()/2

		document.getElementById('female_lf_text').style.marginLeft=parseInt($('#ficon33').css('margin-left'))+2*personwidth
		document.getElementById('female_lf_text').style.marginTop=parseInt($('#ficon33').css('margin-top'))-8+$('#female_lf_text').height()/2

		document.getElementById('male_lf_texthold').style.marginLeft=parseInt($('#micon87').css('margin-left'))+2*personwidth
		document.getElementById('male_lf_texthold').style.marginTop=parseInt($('#micon87').css('margin-top'))-8+$('#female_lf_text').height()/2

		document.getElementById('female_lf_texthold').style.marginLeft=parseInt($('#ficon33').css('margin-left'))+2*personwidth-(1.9*personwidth)
		document.getElementById('female_lf_texthold').style.marginTop=parseInt($('#ficon33').css('margin-top'))-28+$('#female_lf_text').height()/2-38

		document.getElementById('pointer').style.marginLeft=parseInt($('#ficon33').css('margin-left'))+2*personwidth-(1.9*personwidth)+21
		document.getElementById('pointer').style.marginTop=parseInt($('#ficon33').css('margin-top'))-46+$('#female_lf_text').height()/2+7

		if(tallflag==1){
			document.getElementById('female_lf_texthold').style.marginLeft=parseInt($('#ficon33').css('margin-left'))+2*personwidth-(1.9*personwidth)+210
			document.getElementById('female_lf_texthold').style.marginTop=parseInt($('#ficon33').css('margin-top'))-18+$('#female_lf_text').height()/2

			document.getElementById('pointer').style.width=185
			document.getElementById('pointer').style.height=1
			document.getElementById('pointer').style.marginLeft=parseInt($('#ficon33').css('margin-left'))+2*personwidth-(1.9*personwidth)+25
			document.getElementById('pointer').style.marginTop=parseInt($('#ficon33').css('margin-top'))-32+$('#female_lf_text').height()/2+27		
		}

		// lf1 and lf2
		document.getElementById("lf1").style.width=startx+columns*personwidth-$('#ares').width()-40
		document.getElementById("lf1").style.marginLeft=startx+$('#ares').width()+10
		document.getElementById("lf1").style.marginTop=gheight/32
		if(tallflag==1){document.getElementById("lf1").style.marginLeft=gxmiddle-180+$('#ares').width()+10}

		document.getElementById("lf2").style.width=startx+columns*personwidth-$('#venus').width()-40
		document.getElementById("lf2").style.marginLeft=gxmiddle+$('#venus').width()+10
		document.getElementById("lf2").style.marginTop=gheight/32
		
		if(tallflag==1){
			document.getElementById("lf2").style.marginLeft=gxmiddle-180+$('#venus').width()+10
			document.getElementById("lf2").style.marginTop=preserve+27
			document.getElementById("lf1").style.marginTop=gheight/32+27
			document.getElementById("lf2").style.fontSize='1.8em'
			document.getElementById("lf1").style.fontSize='1.8em'
		}

		// update to the bounds for next part of graph to draw from
		gybounds2[0]=endy
		callback()
	}


	function timeseries(callback){

		// yearmarker setup
		document.getElementById("yearmarker").style.marginTop=gybounds2[0];
		document.getElementById("yearmarker").style.marginLeft=gxbounds2[0]-10
		document.getElementById("yearmarker").style.width=140

		var yearmarker_line=g.line(-5+gxbounds2[0]+$('#yearmarker').width()+10,gybounds2[0],-5+gxbounds2[0]+$('#yearmarker').width()+10,gybounds2[0]+$('#yearmarker').height()).attr({stroke:'#3d3242','stroke-width':1,'shape-rendering':'crispEdges'})
		midline=gybounds2[0]+$('#yearmarker').height()/2

		// graph label setup
		document.getElementById("graphlabel").style.marginTop=gybounds2[0]+(gybounds2[1]-gybounds2[0])/2
		document.getElementById("graphlabel").style.marginLeft=gxbounds2[0]+(gxbounds2[1]-gxbounds2[0])/3;
		document.getElementById("graphlabel").style.width=480

		gybounds2[0]=gybounds2[0]+85

		var mm_path=''
		var mhh_path=''
		var mf_path=''

		for(var i=1948;i<1980;i++){
			var y_mm=parseInt(get_value(data[i]['mm_income']))
			var y_mhh=parseInt(get_value(data[i]['mhh_income']))
			var y_mf=parseInt(get_value(data[i]['mf_income']))

			var x=parseInt(gxbounds2[0]+(i-1948)*(yearinterval))

			if(i==1948){
				mm_path='M'+x+' '+y_mm
				mhh_path='M'+x+' '+y_mhh
				mf_path='M'+x+' '+y_mf
			} else{
				mm_path=mm_path+'L'+x+' '+y_mm
				mhh_path=mhh_path+'L'+x+' '+y_mhh
				mf_path=mf_path+'L'+x+' '+y_mf
			}
		}

		for(var i=1979;i<2015;i++){
			var y_mm=parseInt(get_value(data[i]['mm_income']))
			var y_mhh=parseInt(get_value(data[i]['mhh_income']))
			var y_mf=parseInt(get_value(data[i]['mf_income']))

			var x=parseInt(gxbounds2[0]+(i-1948)*(yearinterval))

			if(i==1979){
				mm_path2='M'+x+' '+y_mm
				mhh_path2='M'+x+' '+y_mhh
				mf_path2='M'+x+' '+y_mf
			} else{
				mm_path2=mm_path2+'L'+x+' '+y_mm
				mhh_path2=mhh_path2+'L'+x+' '+y_mhh
				mf_path2=mf_path2+'L'+x+' '+y_mf
			}
		}

		linegroup=g.group()

		// shaded recessions
		var rec1=g.rect(gxbounds2[0]+yearinterval*22,get_value(75000),yearinterval*(.917),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec2=g.rect(gxbounds2[0]+yearinterval*25.917,get_value(75000),yearinterval*(1.333),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec3=g.rect(gxbounds2[0]+yearinterval*32.083,get_value(75000),yearinterval*(.5),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec4=g.rect(gxbounds2[0]+yearinterval*33.583,get_value(75000),yearinterval*(1.333),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec5=g.rect(gxbounds2[0]+yearinterval*42.583,get_value(75000),yearinterval*(.667),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec6=g.rect(gxbounds2[0]+yearinterval*53.25,get_value(75000),yearinterval*(.667),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec7=g.rect(gxbounds2[0]+yearinterval*60,get_value(75000),yearinterval*(1.5),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec8=g.rect(gxbounds2[0]+yearinterval*.917,get_value(75000),yearinterval*(.917),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec9=g.rect(gxbounds2[0]+yearinterval*5.583,get_value(75000),yearinterval*(.833),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec10=g.rect(gxbounds2[0]+yearinterval*9.667,get_value(75000),yearinterval*(.667),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})
		var rec11=g.rect(gxbounds2[0]+yearinterval*12.333,get_value(75000),yearinterval*(.833),get_value(0)-get_value(75000)).attr({fill:'#eee','shape-rendering':'crispEdges',class:'recessions'})

		linegroup.append(rec1)
		linegroup.append(rec2)
		linegroup.append(rec3)
		linegroup.append(rec4)
		linegroup.append(rec5)
		linegroup.append(rec6)
		linegroup.append(rec7)
		linegroup.append(rec8)
		linegroup.append(rec9)
		linegroup.append(rec10)
		linegroup.append(rec11)

		var mm_income_path=g.path(mm_path).attr({fill:'none','stroke-width':'4px','stroke':'#fc8d62','id':'mm_income_path','stroke-linecap':'round'})
		var rmhh_income_path=g.path(mhh_path).attr({fill:'none','stroke-width':'4px','stroke':'#3d3242','id':'mhh_income_path','stroke-linecap':'round'})
		var mf_income_path=g.path(mf_path).attr({fill:'none','stroke-width':'4px','stroke':'#67c2a5','id':'mf_income_path','stroke-linecap':'round'})
		var mm_income_path2=g.path(mm_path2).attr({fill:'none','stroke-width':'4px','stroke':'#fc8d62','id':'mm_income_path2','stroke-linecap':'round'})
		var rmhh_income_path2=g.path(mhh_path2).attr({fill:'none','stroke-width':'4px','stroke':'#3d3242','id':'mhh_income_path2','stroke-linecap':'round'})
		var mf_income_path2=g.path(mf_path2).attr({fill:'none','stroke-width':'4px','stroke':'#67c2a5','id':'mf_income_path2','stroke-linecap':'round'})
		linegroup.append(mm_income_path)
		linegroup.append(mhh_income_path)
		linegroup.append(mf_income_path)
		linegroup.append(mm_income_path2)
		linegroup.append(mhh_income_path2)
		linegroup.append(mf_income_path2)

		var mask=g.rect(gxbounds2[0],gybounds2[0],0,gybounds2[1]-gybounds2[0]+50).attr({fill:'#fff',id:'mask'})
		maskgroup=g.group(mask)
		linegroup.attr({mask:maskgroup})

		// decade markers
		var dec50=g.text(gxbounds2[0]+yearinterval*2,gybounds2[1]+15,'1950').attr({'font-family':'Lato','text-anchor':'middle','font-size':'.8em',fill:'#3d3242'})
		var dec60=g.text(gxbounds2[0]+yearinterval*12,gybounds2[1]+15,'1960').attr({'font-family':'Lato','text-anchor':'middle','font-size':'.8em',fill:'#3d3242'})
		var dec70=g.text(gxbounds2[0]+yearinterval*22,gybounds2[1]+15,'1970').attr({'font-family':'Lato','text-anchor':'middle','font-size':'.8em',fill:'#3d3242'})
		var dec80=g.text(gxbounds2[0]+yearinterval*32,gybounds2[1]+15,'1980').attr({'font-family':'Lato','text-anchor':'middle','font-size':'.8em',fill:'#3d3242'})
		var dec90=g.text(gxbounds2[0]+yearinterval*42,gybounds2[1]+15,'1990').attr({'font-family':'Lato','text-anchor':'middle','font-size':'.8em',fill:'#3d3242'})
		var dec00=g.text(gxbounds2[0]+yearinterval*52,gybounds2[1]+15,'2000').attr({'font-family':'Lato','text-anchor':'middle','font-size':'.8em',fill:'#3d3242'})
		var dec10=g.text(gxbounds2[0]+yearinterval*62,gybounds2[1]+15,'2010').attr({'font-family':'Lato','text-anchor':'middle','font-size':'.8em',fill:'#3d3242'})

		var dec50tick=g.line(gxbounds2[0]+yearinterval*2,gybounds2[1],gxbounds2[0]+yearinterval*2,gybounds2[1]+3).attr({stroke:'#3d3242','stroke-width':1,'shape-rendering':'crispEdges'})
		var dec60tick=g.line(gxbounds2[0]+yearinterval*12,gybounds2[1],gxbounds2[0]+yearinterval*12,gybounds2[1]+3).attr({stroke:'#3d3242','stroke-width':1,'shape-rendering':'crispEdges'})
		var dec70tick=g.line(gxbounds2[0]+yearinterval*22,gybounds2[1],gxbounds2[0]+yearinterval*22,gybounds2[1]+3).attr({stroke:'#3d3242','stroke-width':1,'shape-rendering':'crispEdges'})
		var dec80tick=g.line(gxbounds2[0]+yearinterval*32,gybounds2[1],gxbounds2[0]+yearinterval*32,gybounds2[1]+3).attr({stroke:'#3d3242','stroke-width':1,'shape-rendering':'crispEdges'})
		var dec90tick=g.line(gxbounds2[0]+yearinterval*42,gybounds2[1],gxbounds2[0]+yearinterval*42,gybounds2[1]+3).attr({stroke:'#3d3242','stroke-width':1,'shape-rendering':'crispEdges'})
		var dec00tick=g.line(gxbounds2[0]+yearinterval*52,gybounds2[1],gxbounds2[0]+yearinterval*52,gybounds2[1]+3).attr({stroke:'#3d3242','stroke-width':1,'shape-rendering':'crispEdges'})
		var dec10tick=g.line(gxbounds2[0]+yearinterval*62,gybounds2[1],gxbounds2[0]+yearinterval*62,gybounds2[1]+3).attr({stroke:'#3d3242','stroke-width':1,'shape-rendering':'crispEdges'})

		callback()
	}

	function get_value(y){
		return gybounds2[1]-(y/ymax)*(gybounds2[1]-gybounds2[0])
	}

</script>



















